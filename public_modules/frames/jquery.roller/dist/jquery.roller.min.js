!function(t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t:t()}(function(){function t(t,e){this.sortId=2,this.state="stop",this.edTimer=null,this.ingTimer=null,this.time=e.time,this.loop=e.loop,this.$element=$(t),this.$eVisual=$(e.eVisual),this.$eButton=$(e.eButton),this.$eRoller=$(e.eRoller),this.beRollFunc=e.beRollFunc,this.edRollFunc=e.edRollFunc,this.$eRoller.length>1&&this.event(),this.$eRoller.length>1&&this.init()}$.fn.roller=function(e){return this.each(function(){this._roller instanceof t?this._roller.init():this._roller=new t(this,e)})},t.prototype.init=function(){this.mark(),this.copy(),this.sort(),this.style(),this.toRoll("left")},t.prototype.mark=function(){this.$eRoller.each(function(t){$(this).attr("rollId",t+1)}),this.$eButton.each(function(t){$(this).attr("btnId",t+1)})},t.prototype.copy=function(){var t=this.$eRoller.last().clone(),e=this.$eRoller.first().clone();this.$eRoller.last().after(e),this.$eRoller.first().before(t),this.$eRoller=this.$eRoller.parent().find("[rollId]")},t.prototype.sort=function(){this.$eRoller.each(function(t){$(this).attr("sortId",t+1)})},t.prototype.style=function(){var t=this.$eVisual.width(),e=this.$eVisual.css("position");this.$eVisual.css({position:"absolute"===e?"absolute":"fixed"===e?"fixed":"relative"}),this.$eRoller.each(function(e){$(this).css({transform:"translate3d("+(e-1)*t+"px, 0px, 0px)"})}),this.$eRoller.css({float:"none",transition:"none",position:"absolute",bottom:"auto",right:"auto",left:0,top:0})},t.prototype.event=function(){var t=this;t.$eButton.on("touchstart click","",function(e){clearTimeout(t.ingTimer),clearTimeout(t.edTimer);var o=t.sortId,i=$(this).attr("btnId"),s=t.$eRoller.eq(o-1).attr("rollId");"stop"!==t.state&&t.stop(),i!==s&&(t.rolling(1*i+1),t.toRoll("left"))}),t.$eVisual.on("touchstart",function(e){clearTimeout(t.ingTimer),clearTimeout(t.edTimer),t.stop();var o=(e||window.event).changedTouches;t.SDir=0,t.moveSX=0,t.startX=o[0].clientX,t.$eRoller.css("transition","none")}),t.$eVisual.on("touchmove",function(e){var o=e||window.event,i=o.changedTouches;t.moveX=i[0].clientX,t.moveSX=t.moveX-t.startX,t.$eRoller.each(function(e){var o=(e+1-t.sortId)*t.$eVisual.width()+t.moveSX;$(this).css({transform:"translate3d("+o+"px, 0px, 0px)"})}),o.stopPropagation(),o.preventDefault()}),t.$eVisual.on("touchend",function(){var e=t.$eVisual.width(),o=t.moveSX>e/5?"right":t.moveSX<-e/5?"left":"none";t.rolling(o),t.toRoll("left")})},t.prototype.place=function(t){var e=this;this.state="running",this.$eRoller.each(function(o){var i=(o+1-t)*e.$eVisual.width();$(this).css("transform","translate3d("+i+"px, 0px, 0px)")})},t.prototype.toRoll=function(t){var e=this;e.ingTimer=setTimeout(function(){e.loop&&e.rolling(t),e.loop&&e.toRoll(t)},e.time||3500)},t.prototype.start=function(t){var e=this.sortId,o=this.$eRoller.length;"number"==typeof t&&(this.sortId=t),"right"===t&&(this.sortId=e>0?e-1:o),"left"===t&&(this.sortId=e<o?e+1:1),this.beRollFunc&&this.beRollFunc(this,this.sortId),this.$eRoller.css({transition:"600ms ease"}),this.state="start"},t.prototype.rolling=function(t){var e=this;e.start(t),e.place(this.sortId),e.edTimer=setTimeout(function(){e.stop()},600)},t.prototype.stop=function(){var t=this.sortId,e=this.$eRoller.length;t===e&&(this.sortId=2),1===t&&(this.sortId=e-1),this.$eRoller.css("transition","none"),this.place(this.sortId),this.edRollFunc&&this.edRollFunc(this,t),this.state="stop"}});