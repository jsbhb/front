!function(){"use strict";var e=window.app.getApi("jsData"),o=window.app.getApi("jsUtil"),i=window.app.getApi("jsModel"),t=window.app.getApi("jsEvent"),n=e.userInfo.userId,s=e.userInfo.shopId,r=e.userInfo.gradeId,a=e.userInfo.centerId,l=e.userInfo.isLogin,d=e.userInfo.welfareVip,p=e.location.pathUrl,c=e.siteInfo.shopName,u=e.siteInfo.shopAbout,h=e.siteInfo.shopHeadImg,m=e.siteInfo.shopDescribe,I=e.location.pathname.replace(/(\/?[^\/]+\/)*([^\/]+)\.html$/i,"$2"),f=o.url.getParam("itemId"),w=o.url.getParam("pushUserId"),g=o.url.getParam("jumpUrl",1),j=$.Deferred(),U={icon_home:!0,title_text:"商品详情",icon_search:!0,icon_shopCart:!0};if(!l)return void setTimeout(function(){window.location.href="/login.html?jumpUrl="+p},200);if(d?j.resolve():i.send("USER_INVITERINFO_CHECK",{shopId:s||r,id:n}).done(function(o){o&&o.success&&!0===o.obj?(e.userInfo.welfareVip=!0,window.localStorage.setItem("welfareVip","v:"+s+"-"+n),j.resolve()):(e.userInfo.welfareVip=!1,window.localStorage.removeItem("welfareVip"),window.location.href="/bindInvitation.html?jumpUrl="+p,j.reject())}).fail(function(){setTimeout(function(){window.location.href="/login.html?jumpUrl="+p},200),j.reject()}),o.url.delParam(["shopId","pushUserId"],"cover"),p=o.path.delParam(p,["shopId","pushUserId"]),"isShoper"!==w&&w&&window.localStorage.setItem("pushUserId",w),"isShoper"===w&&w&&window.localStorage.removeItem("pushUserId"),!I&&!f)return void setTimeout(function(){window.location.href="/index.html"},300);var v={jsData:e,jsUtil:o,jsModel:i,jsEvent:t,userId:n,shopId:s,gradeId:r,centerId:a,isLogin:l,welfareVip:d,pathUrl:p,jumpUrl:g,backUrl:"",toRender:j,shopName:c,shopAbout:u,shopHeadImg:h,shopDescribe:m,goodsId:I,itemId:f,initList:U,icon_home:!0,title_text:"商品详情",icon_search:!0,icon_shopCart:!0,home:"",shoppingCart:"",personalCenter:"",goodsDetail:!0,gradientHide:!0};window.app.setPage=function(e,o){"string"==typeof e&&e.trim()&&(v[e]=o)},window.app.getPage=function(e){return"string"==typeof e&&e.trim()?v[e]:v},wx.ready(function(){s=localStorage.getItem("shopId")||2;var e={};-1==window.location.href.indexOf("?")?e.link=window.location.href+"?shopId="+s:e.link=window.location.href+"&shopId="+s,i.send("GOODS_ID_QUERY",{goodsId:I}).done(function(o){o&&o.success&&o.obj&&(e.title=o.obj[0].customGoodsName,e.desc=o.obj[0].description||o.obj[0].customGoodsName,e.imgUrl=o.obj[0].goodsFileList&&o.obj[0].goodsFileList[0].path||""),wx.onMenuShareAppMessage({title:e.title,desc:e.desc,link:e.link,imgUrl:e.imgUrl,success:function(e){}}),wx.onMenuShareTimeline({title:e.title,link:e.link,imgUrl:e.imgUrl,success:function(e){}})})})}();