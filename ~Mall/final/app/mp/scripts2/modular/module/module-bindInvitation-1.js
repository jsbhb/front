define(["config.page.render"],function(e){"use strict";var n=window.capi.get(),o=n.jsData.userInfo.userId,r=n.jsData.userInfo.shopId,t=n.jsData.userInfo.gradeId;return e.extend({tags:{global:"<component-bindinvitation-1></component-bindinvitation-1>"},region:{global:{reqDynamic:!0,resDynamic:!1,beforeFunc:function(e,n){e.response.global.userInfo&&(e.config.global.account=e.response.global.userInfo.phone||"",e.request.global.account=e.response.global.userInfo.phone||"")}}},config:{global:{}},request:{global:{account:"",invitationCode:""},USER_INVITERCODE_BIND:{id:o,shopId:r||t}},response:{global:{}},sendArr:["USER_DETAIL_QUERY/global/userInfo"],reload:!1,".component-bindInvitation-bingBtn:not(.state_error) touchend":function(){var e=this,o=e.modules.message,r=e.renderData.global.config.toDomain,t=e.renderData.global.request.attr();e.jsUtil.weChat.browser()?e.sendRequest("USER_INVITERCODE_BIND",{phone:t.account,invitationCode:t.invitationCode}).done(function(t){if(t&&t.success)if(t&&t.obj)if("fDomainName"===r){var a=n.jsData.userInfo.shopId,s=n.jsData.userInfo.userId,i=n.jsData.userInfo.authId,c=n.jsData.userInfo.openId,l=n.jsData.siteInfo.fDomainName,f="v:"+a+"-"+s;e.jsUtil.url.jumpPage(n.jsUtil.path.setParam(l,{shopId:a,userId:s,authId:i,openId:c,welfareVip:f}),null)}else window.history.go(-1);else t&&t.errorMsg?o.refresh({type:"error",content:t.errorMsg,cancelBtn:!1,confirmBtn:!1}):o.refresh({type:"error",content:"绑定邀请码失败！",cancelBtn:!1,confirmBtn:!1});else t&&t.errorMsg?o.refresh({type:"error",content:t.errorMsg,cancelBtn:!1,confirmBtn:!1}):o.refresh({type:"error",content:"绑定邀请码失败！",cancelBtn:!1,confirmBtn:!1})}).fail(function(){o.refresh({type:"error",content:"绑定邀请码失败！",cancelBtn:!1,confirmBtn:!1})}):o.refresh({cancelBtn:!1,confirmBtn:!1,content:"请在微信端进行操作！"})}})});